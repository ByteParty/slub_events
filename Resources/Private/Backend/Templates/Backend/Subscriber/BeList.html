{namespace se=Slub\SlubEvents\ViewHelpers}
<f:layout name="Default"/>

<f:section name="subscriberListing">
	<table class="tx_slubevents table table-striped table-hover">
		<tr>
			<th>
				<f:translate key="tx_slubevents_domain_model_subscriber.name"/>
			</th>
			<th>
				<f:translate key="tx_slubevents_domain_model_subscriber.crdate"/>
			</th>
			<th>
				<f:translate key="tx_slubevents_domain_model_event.title"/>
			</th>
			<th>
				<f:translate key="tx_slubevents_domain_model_subscriber.number"/>
			</th>
		</tr>
		<f:for each="{subscribers}" as="subscriber" iteration="subscriberIterator">
			<tr class="{f:if(condition: subscriberIterator.isEven, then: 'Even')} {f:if(condition: subscriberIterator.isOdd, then: 'Odd')} {f:if(condition: subscriberIterator.isFirst, then: 'First')} {f:if(condition: subscriberIterator.isLast, then: 'Last')}">
				<td><span class="subscriber"><f:link.email email="{subscriber.email}">{subscriber.name}
				</f:link.email></span></td>
				<td>
					<f:format.date date="{subscriber.crdate}" format="%d.%m.%Y %H:%M"/>
				</td>
				<td>
					<se:be.functionBar icon="geniusbar" event="{subscriber.event}"/>
					<span class="eventtitle" title="<f:format.date date='{subscriber.event.startDateTime}' format='%d.%m.%Y %H:%M' />">
						{subscriber.event.title}
					</span>
				</td>
				<td>{subscriber.number}</td>
			</tr>
		</f:for>
	</table>
</f:section>

<f:section name="content">

	<div class="container-fluid">

		<h1>
			<f:translate key="tx_slubevents.be.subscriberlist"/>
		</h1>

		<f:flashMessages/>

		<div class="filter-panel">
			<f:form action="beList" section="results" name="searchParameter" method="post">
				<div class="row">
					<div class="col-sm-3">
            <div class="form-group">
							<label for="datetimepicker1" class="control-label">
								<f:translate key="tx_slubevents_domain_model_event.start_date_time"/>
							</label>
              <div class='input-group'>
                <f:form.textfield id="datetimepicker1"
                          property="selectedStartDateStamp"
                          size="12"
                          data="{date-type:'date'}"
                          value="{selectedStartDateStamp}"
                          class="form-control t3js-datetimepicker t3js-clearable"
                           />
                <span class="input-group-btn">
                    <label class="btn btn-default" for="datetimepicker1">
                      <span class="fa fa-calendar"></span>
                    </label>
                </span>
              </div>
            </div>
					</div>
					<div class="col-sm-6">
						<f:translate key="tx_slubevents_domain_model_category"/>
						<div class="foldtree">
							<f:render partial="Event/CategoryTree"
												section="categoryTree"
												arguments="{categories: categories, categoriesSelected : categoriesSelected}"/>
						</div>
					</div>
				</div>

				<div class="row">
					<div class="col-xs-12">
						<f:form.submit class="btn btn-primary" value="Suchen..."/>
					</div>
				</div>
			</f:form>
		</div>

    <div id="results">&nbsp;</div>

    <f:if condition="{subscribers}">
      <f:then>
          <f:if condition="{settings.hidePagination}">
              <f:then>
                  <f:render section="subscriberListing" arguments="{subscribers: subscribers}"/>
              </f:then>
              <f:else>
                  <f:widget.paginate objects="{subscribers}" as="paginatedSubscribers"
                      configuration="{settings.list.paginate}">
                  <f:render section="subscriberListing" arguments="{subscribers: paginatedSubscribers}"/>
                </f:widget.paginate>
              </f:else>
          </f:if>
      </f:then>
      <f:else>
          <f:render section="subscriberListing" arguments="{subscribers: subscribers}"/>
      </f:else>
    </f:if>
	</div>
</f:section>
